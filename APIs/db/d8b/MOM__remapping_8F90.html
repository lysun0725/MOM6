<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOM6: src/ALE/MOM_remapping.F90 File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOM6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,'Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('db/d8b/MOM__remapping_8F90.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#namespaces">Modules</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">MOM_remapping.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;MOM_memory.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for MOM_remapping.F90:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/d9a/MOM__remapping_8F90__incl.svg" width="179" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="../../db/d8b/MOM__remapping_8F90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d2b/structmom__remapping_1_1remapping__cs.html">mom_remapping::remapping_cs</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for remapping parameters.  <a href="../../dd/d2b/structmom__remapping_1_1remapping__cs.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:d6/d75/namespacemom__remapping"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html">mom_remapping</a></td></tr>
<tr class="memdesc:d6/d75/namespacemom__remapping"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides column-wise vertical remapping functions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7665afb57dbb63f732dfd0258be94fb9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d8b/MOM__remapping_8F90.html#a7665afb57dbb63f732dfd0258be94fb9">__USE_ROUNDOFF_SAFE_ADJUSTMENTS__</a></td></tr>
<tr class="separator:a7665afb57dbb63f732dfd0258be94fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a9e811f89c505a4416ea0eec315769801"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a9e811f89c505a4416ea0eec315769801">mom_remapping::remapping_set_param</a> (CS, remapping_scheme, boundary_extrapolation, check_reconstruction, check_remapping, force_bounds_in_subcell)</td></tr>
<tr class="memdesc:a9e811f89c505a4416ea0eec315769801"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set parameters within remapping object.  <a href="../../d6/d75/namespacemom__remapping.html#a9e811f89c505a4416ea0eec315769801">More...</a><br /></td></tr>
<tr class="separator:a9e811f89c505a4416ea0eec315769801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80ed96a40bd7320cfe4213e1550365f0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a80ed96a40bd7320cfe4213e1550365f0">mom_remapping::buildgridfromh</a> (nz, h, x)</td></tr>
<tr class="memdesc:a80ed96a40bd7320cfe4213e1550365f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate edge coordinate x from cell width h.  <a href="../../d6/d75/namespacemom__remapping.html#a80ed96a40bd7320cfe4213e1550365f0">More...</a><br /></td></tr>
<tr class="separator:a80ed96a40bd7320cfe4213e1550365f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accd6922c5eb61fa77c11869d8b219f7c"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#accd6922c5eb61fa77c11869d8b219f7c">mom_remapping::ispossumerrsignificant</a> (n1, sum1, n2, sum2)</td></tr>
<tr class="memdesc:accd6922c5eb61fa77c11869d8b219f7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two summation estimates of positive data and judge if due to more than round-off. When two sums are calculated from different vectors that should add up to the same value, the results can differ by round off. The round off error can be bounded to be proportional to the number of operations. This function returns true if the difference between sum1 and sum2 is larger than than the estimated round off bound.  <a href="../../d6/d75/namespacemom__remapping.html#accd6922c5eb61fa77c11869d8b219f7c">More...</a><br /></td></tr>
<tr class="separator:accd6922c5eb61fa77c11869d8b219f7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d1533ffa647f3305aba055e2685b095"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a6d1533ffa647f3305aba055e2685b095">mom_remapping::remapping_core_h</a> (n0, h0, u0, n1, h1, u1, CS)</td></tr>
<tr class="memdesc:a6d1533ffa647f3305aba055e2685b095"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remaps column of values u0 on grid h0 to grid h1 assuming the top edge is aligned.  <a href="../../d6/d75/namespacemom__remapping.html#a6d1533ffa647f3305aba055e2685b095">More...</a><br /></td></tr>
<tr class="separator:a6d1533ffa647f3305aba055e2685b095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b967872b8db2ac7d538991f7f255e56"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a8b967872b8db2ac7d538991f7f255e56">mom_remapping::remapping_core_w</a> (CS, n0, h0, u0, n1, dx, u1)</td></tr>
<tr class="memdesc:a8b967872b8db2ac7d538991f7f255e56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remaps column of values u0 on grid h0 to implied grid h1 where the interfaces of h1 differ from those of h0 by dx.  <a href="../../d6/d75/namespacemom__remapping.html#a8b967872b8db2ac7d538991f7f255e56">More...</a><br /></td></tr>
<tr class="separator:a8b967872b8db2ac7d538991f7f255e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07d7276310f329f56560a1290bcb8b0a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a07d7276310f329f56560a1290bcb8b0a">mom_remapping::build_reconstructions_1d</a> (n0, h0, u0, remapping_scheme, deg, boundary_extrapolation, ppoly_r_coefficients, ppoly_r_E, ppoly_r_S, iMethod)</td></tr>
<tr class="memdesc:a07d7276310f329f56560a1290bcb8b0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates polynomial reconstructions of u0 on the source grid h0.  <a href="../../d6/d75/namespacemom__remapping.html#a07d7276310f329f56560a1290bcb8b0a">More...</a><br /></td></tr>
<tr class="separator:a07d7276310f329f56560a1290bcb8b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62666b08a892ba9e9ab5a4731a07b942"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a62666b08a892ba9e9ab5a4731a07b942">mom_remapping::check_reconstructions_1d</a> (n0, h0, u0, deg, boundary_extrapolation, ppoly_r_coefficients, ppoly_r_E, ppoly_r_S)</td></tr>
<tr class="memdesc:a62666b08a892ba9e9ab5a4731a07b942"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks that edge values and reconstructions satisfy bounds.  <a href="../../d6/d75/namespacemom__remapping.html#a62666b08a892ba9e9ab5a4731a07b942">More...</a><br /></td></tr>
<tr class="separator:a62666b08a892ba9e9ab5a4731a07b942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac27eb299cd36293b458a51b60ac771f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#aac27eb299cd36293b458a51b60ac771f">mom_remapping::remap_via_sub_cells</a> (n0, h0, u0, ppoly0_E, ppoly0_coefficients, n1, h1, method, force_bounds_in_subcell, u1, uh_err, ah_sub, aisub_src, aiss, aise)</td></tr>
<tr class="memdesc:aac27eb299cd36293b458a51b60ac771f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remaps column of n0 values u0 on grid h0 to grid h1 with n1 cells by calculating the n0+n1+1 sub-integrals of the intersection of h0 and h1, and the summing the appropriate integrals into the h1*u1 values.  <a href="../../d6/d75/namespacemom__remapping.html#aac27eb299cd36293b458a51b60ac771f">More...</a><br /></td></tr>
<tr class="separator:aac27eb299cd36293b458a51b60ac771f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97371127053406c84be732a19eb6f9d"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#ac97371127053406c84be732a19eb6f9d">mom_remapping::average_value_ppoly</a> (n0, u0, ppoly0_E, ppoly0_coefficients, method, i0, xa, xb)</td></tr>
<tr class="memdesc:ac97371127053406c84be732a19eb6f9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the average value of a reconstruction within a single source cell, i0, between the non-dimensional positions xa and xb (xa&lt;=xb) with dimensional separation dh.  <a href="../../d6/d75/namespacemom__remapping.html#ac97371127053406c84be732a19eb6f9d">More...</a><br /></td></tr>
<tr class="separator:ac97371127053406c84be732a19eb6f9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe0efe65edb680f96fc5efe3d29a9217"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#afe0efe65edb680f96fc5efe3d29a9217">mom_remapping::measure_input_bounds</a> (n0, h0, u0, ppoly_E, h0tot, h0err, u0tot, u0err, u0min, u0max)</td></tr>
<tr class="memdesc:afe0efe65edb680f96fc5efe3d29a9217"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure totals and bounds on source grid.  <a href="../../d6/d75/namespacemom__remapping.html#afe0efe65edb680f96fc5efe3d29a9217">More...</a><br /></td></tr>
<tr class="separator:afe0efe65edb680f96fc5efe3d29a9217"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5453aeefe69feaff159b67f3a4bd2366"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a5453aeefe69feaff159b67f3a4bd2366">mom_remapping::measure_output_bounds</a> (n1, h1, u1, h1tot, h1err, u1tot, u1err, u1min, u1max)</td></tr>
<tr class="memdesc:a5453aeefe69feaff159b67f3a4bd2366"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure totals and bounds on destination grid.  <a href="../../d6/d75/namespacemom__remapping.html#a5453aeefe69feaff159b67f3a4bd2366">More...</a><br /></td></tr>
<tr class="separator:a5453aeefe69feaff159b67f3a4bd2366"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8b5e5d21e3a888c1d7c368980b67152"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#aa8b5e5d21e3a888c1d7c368980b67152">mom_remapping::remapbyprojection</a> (n0, h0, u0, ppoly0_E, ppoly0_coefficients, n1, h1, method, u1)</td></tr>
<tr class="memdesc:aa8b5e5d21e3a888c1d7c368980b67152"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remaps column of values u0 on grid h0 to grid h1 by integrating over the projection of each h1 cell onto the h0 grid.  <a href="../../d6/d75/namespacemom__remapping.html#aa8b5e5d21e3a888c1d7c368980b67152">More...</a><br /></td></tr>
<tr class="separator:aa8b5e5d21e3a888c1d7c368980b67152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bd9f90e9d589519737e64145f3574f0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a1bd9f90e9d589519737e64145f3574f0">mom_remapping::remapbydeltaz</a> (n0, h0, u0, ppoly0_E, ppoly0_coefficients, n1, dx1, method, u1, h1)</td></tr>
<tr class="memdesc:a1bd9f90e9d589519737e64145f3574f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remaps column of values u0 on grid h0 to implied grid h1 where the interfaces of h1 differ from those of h0 by dx. The new grid is defined relative to the original grid by change dx1(:) = xNew(:) - xOld(:) and the remapping calculated so that hNew(k) qNew(k) = hOld(k) qOld(k) + F(k+1) - F(k) where F(k) = dx1(k) qAverage and where qAverage is the average qOld in the region zOld(k) to zNew(k).  <a href="../../d6/d75/namespacemom__remapping.html#a1bd9f90e9d589519737e64145f3574f0">More...</a><br /></td></tr>
<tr class="separator:a1bd9f90e9d589519737e64145f3574f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70384d9f71e63af37657193da4664a46"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a70384d9f71e63af37657193da4664a46">mom_remapping::integraterecononinterval</a> (n0, h0, u0, ppoly0_E, ppoly0_coefficients, method, xL, xR, hC, uAve, jStart, xStart)</td></tr>
<tr class="memdesc:a70384d9f71e63af37657193da4664a46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrate the reconstructed column profile over a single cell.  <a href="../../d6/d75/namespacemom__remapping.html#a70384d9f71e63af37657193da4664a46">More...</a><br /></td></tr>
<tr class="separator:a70384d9f71e63af37657193da4664a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a494289c324db2496816f2687f4ceea76"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a494289c324db2496816f2687f4ceea76">mom_remapping::dzfromh1h2</a> (n1, h1, n2, h2, dx)</td></tr>
<tr class="memdesc:a494289c324db2496816f2687f4ceea76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the change in interface positions based on h1 and h2.  <a href="../../d6/d75/namespacemom__remapping.html#a494289c324db2496816f2687f4ceea76">More...</a><br /></td></tr>
<tr class="separator:a494289c324db2496816f2687f4ceea76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6847e0c44ccb54fb72587677f90d95b6"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a6847e0c44ccb54fb72587677f90d95b6">mom_remapping::initialize_remapping</a> (CS, remapping_scheme, boundary_extrapolation, check_reconstruction, check_remapping, force_bounds_in_subcell)</td></tr>
<tr class="memdesc:a6847e0c44ccb54fb72587677f90d95b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for remapping control structure.  <a href="../../d6/d75/namespacemom__remapping.html#a6847e0c44ccb54fb72587677f90d95b6">More...</a><br /></td></tr>
<tr class="separator:a6847e0c44ccb54fb72587677f90d95b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41a89ac62578250500b7a450d5fdfae7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a41a89ac62578250500b7a450d5fdfae7">mom_remapping::setreconstructiontype</a> (string, CS)</td></tr>
<tr class="memdesc:a41a89ac62578250500b7a450d5fdfae7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes the method of reconstruction Use this routine to parse a string parameter specifying the reconstruction and re-allocates work arrays appropriately. It is called from initialize_remapping but can be called from an external module too.  <a href="../../d6/d75/namespacemom__remapping.html#a41a89ac62578250500b7a450d5fdfae7">More...</a><br /></td></tr>
<tr class="separator:a41a89ac62578250500b7a450d5fdfae7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ca09dcc83f53137647ba51ba5deb72"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a10ca09dcc83f53137647ba51ba5deb72">mom_remapping::end_remapping</a> (CS)</td></tr>
<tr class="memdesc:a10ca09dcc83f53137647ba51ba5deb72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destrcutor for remapping control structure.  <a href="../../d6/d75/namespacemom__remapping.html#a10ca09dcc83f53137647ba51ba5deb72">More...</a><br /></td></tr>
<tr class="separator:a10ca09dcc83f53137647ba51ba5deb72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad5ec4e3f91e936e34113503d05deeeb"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#aad5ec4e3f91e936e34113503d05deeeb">mom_remapping::remappingunittests</a> ()</td></tr>
<tr class="memdesc:aad5ec4e3f91e936e34113503d05deeeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs unit tests on remapping functions. Should only be called from a single/root thread Returns True if a test fails, otherwise False.  <a href="../../d6/d75/namespacemom__remapping.html#aad5ec4e3f91e936e34113503d05deeeb">More...</a><br /></td></tr>
<tr class="separator:aad5ec4e3f91e936e34113503d05deeeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade3417cf56734c8198a6d2a4249f44f9"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d8b/MOM__remapping_8F90.html#ade3417cf56734c8198a6d2a4249f44f9">test_answer</a> (n, u, u_true, label)</td></tr>
<tr class="memdesc:ade3417cf56734c8198a6d2a4249f44f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if any cell of u and u_true are not identical. Returns false otherwise.  <a href="#ade3417cf56734c8198a6d2a4249f44f9">More...</a><br /></td></tr>
<tr class="separator:ade3417cf56734c8198a6d2a4249f44f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae73217378610cdc5877ab7cb2a11740d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d8b/MOM__remapping_8F90.html#ae73217378610cdc5877ab7cb2a11740d">dumpgrid</a> (n, h, x, u)</td></tr>
<tr class="memdesc:ae73217378610cdc5877ab7cb2a11740d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience function for printing grid to screen.  <a href="#ae73217378610cdc5877ab7cb2a11740d">More...</a><br /></td></tr>
<tr class="separator:ae73217378610cdc5877ab7cb2a11740d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3dad5d18f7b13f14230f9c50f976c14d"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a3dad5d18f7b13f14230f9c50f976c14d">mom_remapping::remapping_pcm</a> = 0</td></tr>
<tr class="memdesc:a3dad5d18f7b13f14230f9c50f976c14d"><td class="mdescLeft">&#160;</td><td class="mdescRight">O(h^1) remapping scheme.  <a href="../../d6/d75/namespacemom__remapping.html#a3dad5d18f7b13f14230f9c50f976c14d">More...</a><br /></td></tr>
<tr class="separator:a3dad5d18f7b13f14230f9c50f976c14d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac174af1d37725840215d9e65525b4a58"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#ac174af1d37725840215d9e65525b4a58">mom_remapping::remapping_plm</a> = 1</td></tr>
<tr class="memdesc:ac174af1d37725840215d9e65525b4a58"><td class="mdescLeft">&#160;</td><td class="mdescRight">O(h^2) remapping scheme.  <a href="../../d6/d75/namespacemom__remapping.html#ac174af1d37725840215d9e65525b4a58">More...</a><br /></td></tr>
<tr class="separator:ac174af1d37725840215d9e65525b4a58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40ab417b859bc139c78739f29291641f"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a40ab417b859bc139c78739f29291641f">mom_remapping::remapping_ppm_h4</a> = 2</td></tr>
<tr class="memdesc:a40ab417b859bc139c78739f29291641f"><td class="mdescLeft">&#160;</td><td class="mdescRight">O(h^3) remapping scheme.  <a href="../../d6/d75/namespacemom__remapping.html#a40ab417b859bc139c78739f29291641f">More...</a><br /></td></tr>
<tr class="separator:a40ab417b859bc139c78739f29291641f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a186e67e08bd3485a2850d20ecbf3be85"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a186e67e08bd3485a2850d20ecbf3be85">mom_remapping::remapping_ppm_ih4</a> = 3</td></tr>
<tr class="memdesc:a186e67e08bd3485a2850d20ecbf3be85"><td class="mdescLeft">&#160;</td><td class="mdescRight">O(h^3) remapping scheme.  <a href="../../d6/d75/namespacemom__remapping.html#a186e67e08bd3485a2850d20ecbf3be85">More...</a><br /></td></tr>
<tr class="separator:a186e67e08bd3485a2850d20ecbf3be85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a782d61555a87cd8a68a37ed8a9bb4a95"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a782d61555a87cd8a68a37ed8a9bb4a95">mom_remapping::remapping_pqm_ih4ih3</a> = 4</td></tr>
<tr class="memdesc:a782d61555a87cd8a68a37ed8a9bb4a95"><td class="mdescLeft">&#160;</td><td class="mdescRight">O(h^4) remapping scheme.  <a href="../../d6/d75/namespacemom__remapping.html#a782d61555a87cd8a68a37ed8a9bb4a95">More...</a><br /></td></tr>
<tr class="separator:a782d61555a87cd8a68a37ed8a9bb4a95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0890124a6b6d71f31c6d382f52172337"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a0890124a6b6d71f31c6d382f52172337">mom_remapping::remapping_pqm_ih6ih5</a> = 5</td></tr>
<tr class="memdesc:a0890124a6b6d71f31c6d382f52172337"><td class="mdescLeft">&#160;</td><td class="mdescRight">O(h^5) remapping scheme.  <a href="../../d6/d75/namespacemom__remapping.html#a0890124a6b6d71f31c6d382f52172337">More...</a><br /></td></tr>
<tr class="separator:a0890124a6b6d71f31c6d382f52172337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1cc04f1f416e9132c98a416e3cf286d"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#ac1cc04f1f416e9132c98a416e3cf286d">mom_remapping::integration_pcm</a> = 0</td></tr>
<tr class="memdesc:ac1cc04f1f416e9132c98a416e3cf286d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Piecewise Constant Method.  <a href="../../d6/d75/namespacemom__remapping.html#ac1cc04f1f416e9132c98a416e3cf286d">More...</a><br /></td></tr>
<tr class="separator:ac1cc04f1f416e9132c98a416e3cf286d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37c86f210a0a7732da5906716f080141"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a37c86f210a0a7732da5906716f080141">mom_remapping::integration_plm</a> = 1</td></tr>
<tr class="memdesc:a37c86f210a0a7732da5906716f080141"><td class="mdescLeft">&#160;</td><td class="mdescRight">Piecewise Linear Method.  <a href="../../d6/d75/namespacemom__remapping.html#a37c86f210a0a7732da5906716f080141">More...</a><br /></td></tr>
<tr class="separator:a37c86f210a0a7732da5906716f080141"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ad21cf7ed0b74aeb469799d9d748c85"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a1ad21cf7ed0b74aeb469799d9d748c85">mom_remapping::integration_ppm</a> = 3</td></tr>
<tr class="memdesc:a1ad21cf7ed0b74aeb469799d9d748c85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Piecewise Parabolic Method.  <a href="../../d6/d75/namespacemom__remapping.html#a1ad21cf7ed0b74aeb469799d9d748c85">More...</a><br /></td></tr>
<tr class="separator:a1ad21cf7ed0b74aeb469799d9d748c85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a356299a6f7a626edd65e449246a4b60d"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a356299a6f7a626edd65e449246a4b60d">mom_remapping::integration_pqm</a> = 5</td></tr>
<tr class="memdesc:a356299a6f7a626edd65e449246a4b60d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Piecewise Quartic Method.  <a href="../../d6/d75/namespacemom__remapping.html#a356299a6f7a626edd65e449246a4b60d">More...</a><br /></td></tr>
<tr class="separator:a356299a6f7a626edd65e449246a4b60d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6969aba124ed66e102c11eebf4e08484"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d60/version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=40)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a6969aba124ed66e102c11eebf4e08484">mom_remapping::mod</a> = &quot;MOM_remapping&quot;</td></tr>
<tr class="memdesc:a6969aba124ed66e102c11eebf4e08484"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module's name.  <a href="../../d6/d75/namespacemom__remapping.html#a6969aba124ed66e102c11eebf4e08484">More...</a><br /></td></tr>
<tr class="separator:a6969aba124ed66e102c11eebf4e08484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5a45fb3f4f16cc89405a51fd7361cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d60/version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=256), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a8c5a45fb3f4f16cc89405a51fd7361cc">mom_remapping::remappingschemesdoc</a> = &quot;PCM (1st-order accurate)\n&quot;// &quot;PLM (2nd-order accurate)\n&quot;// &quot;PPM_H4 (3rd-order accurate)\n&quot;// &quot;PPM_IH4 (3rd-order accurate)\n&quot;// &quot;PQM_IH4IH3 (4th-order accurate)\n&quot;// &quot;PQM_IH6IH5 (5th-order accurate)\n&quot;</td></tr>
<tr class="memdesc:a8c5a45fb3f4f16cc89405a51fd7361cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Documentation for external callers.  <a href="../../d6/d75/namespacemom__remapping.html#a8c5a45fb3f4f16cc89405a51fd7361cc">More...</a><br /></td></tr>
<tr class="separator:a8c5a45fb3f4f16cc89405a51fd7361cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5978c723e71e49b2f54768fea10000cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d60/version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=3), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a5978c723e71e49b2f54768fea10000cb">mom_remapping::remappingdefaultscheme</a> = &quot;PLM&quot;</td></tr>
<tr class="memdesc:a5978c723e71e49b2f54768fea10000cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default remapping method.  <a href="../../d6/d75/namespacemom__remapping.html#a5978c723e71e49b2f54768fea10000cb">More...</a><br /></td></tr>
<tr class="separator:a5978c723e71e49b2f54768fea10000cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e6e40557f03f7c7d110ef57e78512bf"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a3e6e40557f03f7c7d110ef57e78512bf">mom_remapping::h_neglect</a> = 1.E-30</td></tr>
<tr class="memdesc:a3e6e40557f03f7c7d110ef57e78512bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">A dimensional (H units) number that can be added to thicknesses in a denominator without changing the numerical result, except where a division by zero would otherwise occur.  <a href="../../d6/d75/namespacemom__remapping.html#a3e6e40557f03f7c7d110ef57e78512bf">More...</a><br /></td></tr>
<tr class="separator:a3e6e40557f03f7c7d110ef57e78512bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b7945e5d6bd0a3387df90476eca0014"><td class="memItemLeft" align="right" valign="top">logical, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/namespacemom__remapping.html#a8b7945e5d6bd0a3387df90476eca0014">mom_remapping::old_algorithm</a> = .true.</td></tr>
<tr class="memdesc:a8b7945e5d6bd0a3387df90476eca0014"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use the old "broken" algorithm. This is a temporary measure to assist debugging until we delete the old algorithm.  <a href="../../d6/d75/namespacemom__remapping.html#a8b7945e5d6bd0a3387df90476eca0014">More...</a><br /></td></tr>
<tr class="separator:a8b7945e5d6bd0a3387df90476eca0014"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7665afb57dbb63f732dfd0258be94fb9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __USE_ROUNDOFF_SAFE_ADJUSTMENTS__</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae73217378610cdc5877ab7cb2a11740d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine remappingunittests::dumpgrid </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convenience function for printing grid to screen. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of cells</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Cell thickness</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Interface delta</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Cell average values </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8b/MOM__remapping_8F90_source.html#l01758">1758</a> of file <a class="el" href="../../db/d8b/MOM__remapping_8F90_source.html">MOM_remapping.F90</a>.</p>

<p>Referenced by <a class="el" href="../../db/d8b/MOM__remapping_8F90_source.html#l01528">mom_remapping::remappingunittests()</a>.</p>
<div class="fragment"><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n<span class="comment"> !&lt; Number of cells</span></div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: h<span class="comment"> !&lt; Cell thickness</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: x<span class="comment"> !&lt; Interface delta</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: u<span class="comment"> !&lt; Cell average values</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <span class="keywordtype">integer</span> :: i</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(&quot;i=&quot;,20i10)&#39;</span>) (i,i=1,n+1)</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(&quot;x=&quot;,20es10.2)&#39;</span>) (x(i),i=1,n+1)</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(&quot;i=&quot;,5x,20i10)&#39;</span>) (i,i=1,n)</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(&quot;h=&quot;,5x,20es10.2)&#39;</span>) (h(i),i=1,n)</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(&quot;u=&quot;,5x,20es10.2)&#39;</span>) (u(i),i=1,n)</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../db/d8b/MOM__remapping_8F90_ae73217378610cdc5877ab7cb2a11740d_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ade3417cf56734c8198a6d2a4249f44f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function remappingunittests::test_answer </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>u_true</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d60/version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true if any cell of u and u_true are not identical. Returns false otherwise. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of cells in u</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Values to test</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u_true</td><td>Values to test against (correct answer)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">label</td><td>Message </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8b/MOM__remapping_8F90_source.html#l01732">1732</a> of file <a class="el" href="../../db/d8b/MOM__remapping_8F90_source.html">MOM_remapping.F90</a>.</p>

<p>Referenced by <a class="el" href="../../db/d8b/MOM__remapping_8F90_source.html#l01528">mom_remapping::remappingunittests()</a>.</p>
<div class="fragment"><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="keywordtype">integer</span>,            <span class="keywordtype">intent(in)</span> :: n<span class="comment"> !&lt; Number of cells in u</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">dimension(n)</span>, <span class="keywordtype">intent(in)</span> :: u<span class="comment"> !&lt; Values to test</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">dimension(n)</span>, <span class="keywordtype">intent(in)</span> :: u_true<span class="comment"> !&lt; Values to test against (correct answer)</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordtype">character(len=*)</span>,   <span class="keywordtype">intent(in)</span> :: label<span class="comment"> !&lt; Message</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="comment">! Local variables</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="keywordtype">integer</span> :: k</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <a class="code" href="../../db/d8b/MOM__remapping_8F90.html#ade3417cf56734c8198a6d2a4249f44f9">test_answer</a> = .false.</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keywordflow">do</span> k = 1, n</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <span class="keywordflow">if</span> (u(k) /= u_true(k)) <a class="code" href="../../db/d8b/MOM__remapping_8F90.html#ade3417cf56734c8198a6d2a4249f44f9">test_answer</a> = .true.</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../db/d8b/MOM__remapping_8F90.html#ade3417cf56734c8198a6d2a4249f44f9">test_answer</a> .or. .true.) <span class="keywordflow">then</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(a4,2a24,x,a)&#39;</span>) <span class="stringliteral">&#39;k&#39;</span>,<span class="stringliteral">&#39;Calculated value&#39;</span>,<span class="stringliteral">&#39;Correct value&#39;</span>,label</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="keywordflow">do</span> k = 1, n</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <span class="keywordflow">if</span> (u(k) /= u_true(k)) <span class="keywordflow">then</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;          <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(i4,1p2e24.16,a,1pe24.16,a)&#39;</span>) k,u(k),u_true(k),<span class="stringliteral">&#39; err=&#39;</span>,u(k)-u_true(k),<span class="stringliteral">&#39; &lt; wrong&#39;</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;          <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(i4,1p2e24.16)&#39;</span>) k,u(k),u_true(k)</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div><div class="ttc" id="MOM__remapping_8F90_html_ade3417cf56734c8198a6d2a4249f44f9"><div class="ttname"><a href="../../db/d8b/MOM__remapping_8F90.html#ade3417cf56734c8198a6d2a4249f44f9">test_answer</a></div><div class="ttdeci">logical function test_answer(n, u, u_true, label)</div><div class="ttdoc">Returns true if any cell of u and u_true are not identical. Returns false otherwise. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8b/MOM__remapping_8F90_source.html#l01732">MOM_remapping.F90:1732</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../db/d8b/MOM__remapping_8F90_ade3417cf56734c8198a6d2a4249f44f9_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_46c4efbc2fdd36aaff2d92f0d53bbc5f.html">ALE</a></li><li class="navelem"><a class="el" href="../../db/d8b/MOM__remapping_8F90.html">MOM_remapping.F90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
